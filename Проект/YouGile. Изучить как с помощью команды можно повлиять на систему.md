#windows #automation #powershell #cmd #registry #system-administration #Yougile #–ü—Ä–æ–µ–∫—Ç #–∞—Ä—Ç–µ—Ñ–∞–∫—Ç
# ü™ü –ö–∞–∫ –∏–∑–º–µ–Ω—è—Ç—å Windows —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—ã –∏ —Å–∫—Ä–∏–ø—Ç—ã

> üí° –í Windows –º–æ–∂–Ω–æ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ –≤–ª–∏—è—Ç—å –Ω–∞ –ø–æ—á—Ç–∏ –≤—Å–µ –∞—Å–ø–µ–∫—Ç—ã —Å–∏—Å—Ç–µ–º—ã ‚Äî –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Å–µ—Ç–µ–π –¥–æ —Ä–µ–µ—Å—Ç—Ä–∞ –∏ –ø–æ–ª–∏—Ç–∏–∫.

---

## üîß –û—Å–Ω–æ–≤–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏—è –Ω–∞ —Å–∏—Å—Ç–µ–º—É

### 1. **–ö–æ–º–∞–Ω–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ (`cmd.exe`)**
- –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –±–∞–∑–æ–≤–æ–π –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏.
- –†–∞–±–æ—Ç–∞–µ—Ç —Å —Ñ–∞–π–ª–∞–º–∏, —Å–ª—É–∂–±–∞–º–∏, —Ä–µ–µ—Å—Ç—Ä–æ–º, —Å–µ—Ç—å—é.
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `.bat` / `.cmd` —Å–∫—Ä–∏–ø—Ç—ã.

#### –ü—Ä–∏–º–µ—Ä—ã:
```cmd
:: –£–¥–∞–ª–∏—Ç—å –ø–∞–ø–∫—É —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ
rmdir /s /q C:\temp\junk

:: –û—Ç–∫–ª—é—á–∏—Ç—å —Å–ª—É–∂–±—É –ø–µ—á–∞—Ç–∏
net stop Spooler

:: –ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä —Ä–µ–µ—Å—Ç—Ä–∞
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v Hidden /t REG_DWORD /d 1 /f
```

---

### 2. **PowerShell**
- –°–∞–º—ã–π –º–æ—â–Ω—ã–π –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è.
- –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ .NET, WMI, CIM, —Ä–µ–µ—Å—Ç—Ä—É, –ø–æ–ª–∏—Ç–∏–∫–∞–º.
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–ª–æ–∂–Ω—É—é –ª–æ–≥–∏–∫—É, —Ñ—É–Ω–∫—Ü–∏–∏, –º–æ–¥—É–ª–∏.
- –°–∫—Ä–∏–ø—Ç—ã: `.ps1`

#### –ü—Ä–∏–º–µ—Ä—ã:
```powershell
# –°–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
New-LocalUser -Name "TestUser" -Password (ConvertTo-SecureString "P@ssw0rd!" -AsPlainText -Force)

# –û—Ç–∫–ª—é—á–∏—Ç—å UAC
Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "EnableLUA" -Value 0

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –ü–ö –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ
Restart-Computer -Force
```

> ‚ö†Ô∏è –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ `.ps1`-—Å–∫—Ä–∏–ø—Ç–æ–≤ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ.  
> –†–∞–∑—Ä–µ—à–∏—Ç—å:  
> ```powershell
> Set-ExecutionPolicy RemoteSigned -Scope CurrentUser
> ```

---

### 3. **–†–µ–¥–∞–∫—Ç–æ—Ä —Ä–µ–µ—Å—Ç—Ä–∞ (`regedit` / `reg`)**
- –†–µ–µ—Å—Ç—Ä ‚Äî —è–¥—Ä–æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Windows.
- –ß–µ—Ä–µ–∑ –Ω–µ–≥–æ –º–æ–∂–Ω–æ:
  - –ú–µ–Ω—è—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ü—Ä–æ–≤–æ–¥–Ω–∏–∫–∞
  - –û—Ç–∫–ª—é—á–∞—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è)
  - –ù–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

#### –ö–æ–º–∞–Ω–¥—ã:
```cmd
REM –í—ã–≤–æ–¥–∏—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å–ª—É–∂–± –∏ –¥—Ä–∞–π–≤–µ—Ä–æ–≤, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≤ —Å–∏—Å—Ç–µ–º–µ.
reg query "HKLM\SYSTEM\CurrentControlSet\Services"

REM –ü–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª—è–µ—Ç —Ä–∞–∑–¥–µ–ª —Ä–µ–µ—Å—Ç—Ä–∞ MyApp(–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π) –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
reg delete "HKCU\Software\MyApp" /f
```

---

### 4. **–°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã**

| –£—Ç–∏–ª–∏—Ç–∞        | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                  |
| -------------- | ------------------------------------------- |
| `netsh`        | –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ç–∏ –∏ –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä–∞                |
| `schtasks`     | –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á (–∑–∞–ø—É—Å–∫ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é)    |
| `gpupdate`     | –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≥—Ä—É–ø–ø–æ–≤—ã—Ö –ø–æ–ª–∏—Ç–∏–∫ |
| `sfc /scannow` | –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤       |
| `DISM`         | –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞–∑–∞ Windows               |

#### –ü—Ä–∏–º–µ—Ä—ã:
```cmd
:: –°–±—Ä–æ—Å–∏—Ç—å —Å–µ—Ç–µ–≤–æ–π —Å—Ç–µ–∫
netsh int ip reset
netsh winsock reset

:: –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫—É
schtasks /create /tn "RebootAtNight" /tr "shutdown /r /f /t 0" /sc daily /st 02:00
```

---

### 5. **–°–∫—Ä–∏–ø—Ç—ã**

#### üìú –ü–∞–∫–µ—Ç–Ω—ã–µ —Ñ–∞–π–ª—ã (`.bat`, `.cmd`)
- –ü—Ä–æ—Å—Ç—ã–µ, —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ —Å–æ –≤—Å–µ–º–∏ –≤–µ—Ä—Å–∏—è–º–∏ Windows.
- –ü–æ–¥—Ö–æ–¥—è—Ç –¥–ª—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π.

```bat
@echo off
echo –û—á–∏—Å—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤...
del /q %TEMP%\*
echo –ì–æ—Ç–æ–≤–æ!
pause
```

#### ‚ö° PowerShell-—Å–∫—Ä–∏–ø—Ç—ã (`.ps1`)
- –ì–∏–±–∫–∏–µ, –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ, –º–æ—â–Ω—ã–µ.
---

### 6. **–ü—Ä–∞–≤–∞ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**

- –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ç—Ä–µ–±—É—é—Ç **–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã—Ö –ø—Ä–∞–≤**.
- UAC (–ö–æ–Ω—Ç—Ä–æ–ª—å —É—á—ë—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π) –º–æ–∂–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –±–µ–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è.
- –í—Å–µ–≥–¥–∞ –∑–∞–ø—É—Å–∫–∞–π—Ç–µ —Ç–µ—Ä–º–∏–Ω–∞–ª **–æ—Ç –∏–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞**, –µ—Å–ª–∏ –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –º–µ–Ω—è—Ç—å —Å–∏—Å—Ç–µ–º—É.

---

## ‚úÖ –ß—Ç–æ –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å?

–° –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥ –∏ —Å–∫—Ä–∏–ø—Ç–æ–≤ –≤—ã –º–æ–∂–µ—Ç–µ —É–ø—Ä–∞–≤–ª—è—Ç—å:

- üë§ **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –≥—Ä—É–ø–ø–∞–º–∏**
- üîê **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é –∏ –ø–æ–ª–∏—Ç–∏–∫–∞–º–∏**
- üåê **–°–µ—Ç–µ–≤—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –∏ –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä–æ–º**
- ‚öôÔ∏è **–°–ª—É–∂–±–∞–º–∏ –∏ –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–æ–π**
- üìÅ **–§–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π –∏ –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞**
- üñ•Ô∏è **–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º –∏ –ø–æ–≤–µ–¥–µ–Ω–∏–µ–º –û–°**
- üîÑ **–û–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ–º**
